## Jetset: Targeted Firmware Rehosting for Embedded Systems 

### 摘要：

为了解决固件rehosting过程中所需要的外设返回值，结合符号执行工具angr，推理外设预期行为（例如寄存器应该返回的值（纯虚拟化，没有与硬件外设结合））然后用合成的设备来模拟固件，最终测试13个固件，使得固件成功运行，并发现一个特权升级漏洞

### 介绍：



### 相关工作：

Avatar（半虚拟化？与硬件结合，涉及转发IO操作，但也是与符号执行工具S2E相结合，推断返回值）

P2IE （虚拟化，没有用到真实外设？与fuzzing技术结合，启发式搜索）

FIE/ Pretender/firm USB / firmadyne



### 外围推断：

符号执行 推断 寄存器应该返回的值

### 外围合成：

得到约束后，Z3求解

### 搜索策略：

#### 禁忌搜索（Tabu）

​	复杂非线性搜索，

​	CFG 图 基本块距离，

距离作为启发式搜索的一个条件，判断路径是否可达，以及选择哪条路经，

不可达时进行回溯

### Jetset实现

#### 符号执行：

angr-+z3

5500-python / 2000 - C

1. qemu自带的中断注入-qemu_set_irq
2. 增量CFG生成 - 依赖距离函数来引导执行，



个人总结：

为了解决固件rehosting过程中所需要的外设返回值，结合符号执行，推理外设应该返回的值（纯虚拟化，没有与硬件外设结合）最终 使用13个固件，使得固件成功运行，并发现一个特权升级漏洞



